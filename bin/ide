#!/bin/bash
#
# ide - IDE packages for swgemu development environment
#
# Author: Scurby <scurby@swgemu.com>
#
# Created: Oct 9 2016
# TODO quiet the apt commands

logger -t options "** OPTIONS **"

##############################################################################
# Common functions and setup
##############################################################################
yorn() {
  echo -n -e "$@ Y\b"
  read yorn
  case $yorn in
    [Nn]* ) return 1;;
  esac
  return 0
}

logstep() {
  let "step=$step + 1"
  echo ${tc_smso}$(head -c $(tput cols) < /dev/zero | tr '\0' '*')${tc_rmso}
  echo "${tc_smso}**${tc_rmso} STEP $step >> $*"
  logger -t options "STEP $step >> $*"
}

step=0
tc_smso=$(tput smso)
tc_rmso=$(tput rmso)


################
# QTCreator
################
sudo apt-get install qtcreator








################
# Atom
################
if yorn "Would you like to install Atom ?"; then
	sudo apt-get install gvfs-bin
	cd setup
	wget -O atom-amd64.deb https://atom.io/download/deb
	sudo dpkg -i atom-amd64.deb
fi

#################
# Eclipse install
#################
logstep "Setup Eclipse"

dir=~/setup/
eclipse_base=~/setup/eclipse-cpp-mars-2-linux-gtk-x86_64.tar.gz

if yorn "Would you like to install Eclipse??"; then
  if [ ! -f $eclipse_base ]; then
    cd $dir
    wget http://mirrors.xmission.com/eclipse/technology/epp/downloads/release/mars/2/eclipse-cpp-mars-2-linux-gtk-x86_64.tar.gz
  fi

  if [ -d ~/eclipse ]; then
    echo "Looks like eclipse is already installed"
  else
    echo "Restoring basic eclipse install from $eclipse_base"
    cd ~
    ~/bin/bar $eclipse_base | tar xfz -
    echo "Import eclipse project settings (might take a few minutes)"
    for i in Core3/MMOCoreORB PublicEngine/MMOEngine Tools/*
    do
      if [ -f ~/workspace/$i/.project ]; then
        echo "Importing $i"
        ~/eclipse/eclipse \
        -nosplash \
        -data ~/workspace \
        -application org.eclipse.cdt.managedbuilder.core.headlessbuild \
        -import ~/workspace/$i
      else
        echo "Missing project file for $i?"
      fi
    done

    for dir in ~/workspace/.metadata/.plugins/org.eclipse.core.resources/.projects/*
    do
      echo "Setup Egit properties for "$(basename $dir)
      cd $dir
      tar xzf ~/setup/Egit-properties.tar.gz
    done
    echo "Eclipse setup and import complete"
    echo "Add additional packages in Eclipse as desired. (LUA Development Tools is recommended. )"
  fi
fi

######################
# wxLua wxWidgets
######################
# cd Downloads
# TODO test on fresh

wget https://raw.githubusercontent.com/pkulchenko/ZeroBraneStudio/master/build/build-linux.sh

sudo apt-get install libgtk-3-dev build-essential checkinstall
sudo apt-get install gtk+-2.0

./wxLuainstall wxwidgets wxlua


#########
# wget https://sourceforge.net/projects/wxlua/files/wxlua/2.8.12.3/wxLua-2.8.12.3-src.tar.gz
# tar xzf ~/setup/wxLua-2.8.12.3-src.tar.gz

#########
# cd setup
# wget https://github.com/wxWidgets/wxWidgets/releases/download/v3.1.0/wxWidgets-3.1.0.tar.bz2
# tar xjvf ~/setup/wxWidgets-3.1.0.tar.bz2
sudo apt-get install libgtk-3-dev build-essential checkinstall
# mkdir gtk-build
# cd gtk-build/
# cd ~/home/swgemu/setup/wxWidgets-3.1.0
# ./configure --disable-shared --enable-unicode
# make
# # sudo make install
# sudo checkinstall

########
# sudo apt-get install cmake
#
# wget https://sourceforge.net/projects/wxlua/files/wxlua/2.8.12.3/wxLua-2.8.12.3-src.tar.gz


######################
# Remove un-needed files
######################
	# TODO remove tarballs
logstep "Finalizing install"
#  sudo apt-get -y update &>> ~/Documents/pkglog.txt
  echo
  echo "Thanks for the fish...  "
  echo

exit 0
